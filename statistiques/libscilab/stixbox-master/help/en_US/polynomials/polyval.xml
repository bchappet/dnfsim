<?xml version="1.0" encoding="UTF-8"?>

<!--
 *
 * This help file was generated from polyval.sci using help_from_sci().
 *
 -->

<refentry version="5.0-subset Scilab" xml:id="polyval" xml:lang="en"
          xmlns="http://docbook.org/ns/docbook"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          xmlns:svg="http://www.w3.org/2000/svg"
          xmlns:ns3="http://www.w3.org/1999/xhtml"
          xmlns:mml="http://www.w3.org/1998/Math/MathML"
          xmlns:scilab="http://www.scilab.org"
          xmlns:db="http://docbook.org/ns/docbook">

  <refnamediv>
    <refname>polyval</refname>
    <refpurpose>Polynomial evaluation</refpurpose>
  </refnamediv>


<refsynopsisdiv>
   <title>Calling Sequence</title>
   <synopsis>
   y = polyval(p,x)
   y = polyval(p,x,S)
   [y,delta] = polyval(p,x,S)
   
   </synopsis>
</refsynopsisdiv>

<refsection>
   <title>Parameters</title>
   <variablelist>
   <varlistentry><term>p :</term>
      <listitem><para> a (n+1)-by-1 matrix of doubles, the coefficients of the polynomial, with powers in decreasing order</para></listitem></varlistentry>
   <varlistentry><term>x :</term>
      <listitem><para> a nx-by-my matrix of doubles, the points where to evaluate the polynomial</para></listitem></varlistentry>
   <varlistentry><term>S :</term>
      <listitem><para> the optional data structure from polyfit</para></listitem></varlistentry>
   <varlistentry><term>y :</term>
      <listitem><para> a nx-by-my matrix of doubles, the value of the polynomial at x</para></listitem></varlistentry>
   <varlistentry><term>delta :</term>
      <listitem><para> </para></listitem></varlistentry>
   </variablelist>
</refsection>

<refsection>
   <title>Description</title>
   <para>
If p is a vector of length n+1 whose elements are the coefficients of
a polynomial, then <literal>y=polyval(p,x)</literal> is the value of the polynomial,
defined by its coefficients p, evaluated at x.
   </para>
   <para>
These coefficients are ordered with powers in decreasing order:
   </para>
   <para>
<latex>
p(x) = p_1 x^n + p_2 x^{n-1} + ... + p_n x + p_{n+1}.
</latex>
   </para>
   <para>
If x is a matrix, the polynomial is evaluated at all
points in x.
   </para>
   <para>
<literal>[y,delta] = polyval(p,x,S)</literal> uses the optional output generated by
<literal>polyfit</literal> to generate error estimates, y+/-delta.
   </para>
   <para>
</para>
</refsection>

<refsection>
   <title>Examples</title>
   <programlisting role="example"><![CDATA[
p=[3 2 1];
y=polyval(p,[5 7 9])
expected=[86 162 262]

// Evaluate for x matrix
x = linspace(0,%pi,10);
y = sin(x);
p = polyfit(x,y,3);
// Evaluate at x matrix
x = linspace(0,%pi,12);
x=matrix(x,3,4)
f=polyval(p,x)
y=sin(x)

// Evaluate 95% confidence bounds,
// i.e. +/- 2*delta
// Source: [1,2]
cdate=(1790:10:1990)';
pop=[
3.929214
5.308483
7.239881
9.638453
12.860702
17.063353
23.191876
31.443321
38.558371
50.189209
62.979766
76.212168
92.228496
106.02154
123.20262
132.16457
151.3258
179.32317
203.30203
226.5422
248.70987
];
scf();
plot(cdate,pop,"+")
// Calculate fit parameters
[p,S] = polyfit(cdate,pop,2);
// Evaluate the fit and the prediction error estimate (delta)
[pop_fit,delta] = polyval(p,cdate,S);
// Plot the data, the fit, and the confidence bounds
plot(cdate,pop_fit,"g-")
plot(cdate,pop_fit+2*delta,"r:")
plot(cdate,pop_fit-2*delta,"r:")
// Annotate the plot
xlabel("Census Year");
ylabel("Population (millions)");
title("Quadratic Polynomial Fit with Confidence Bounds")

   ]]></programlisting>
</refsection>

<refsection>
   <title>Authors</title>
   <simplelist type="vert">
   <member>Copyright (C) 2013 - Michael Baudin</member>
   <member>Copyright (C) 2010 - DIGITEO - Michael Baudin</member>
   <member>Copyright (C) 1993 - 1995 - Anders Holtsberg</member>
   </simplelist>
</refsection>

<refsection>
   <title>Bibliography</title>
   <para>[1] http://en.wikipedia.org/wiki/Polynomial_interpolation</para>
   <para>[2] http://www.mathworks.fr/fr/help/matlab/data_analysis/programmatic-fitting.html</para>
   <para>[3] Numerical Computing with MATLAB, Cleve Moler, 2004</para>
</refsection>
</refentry>
