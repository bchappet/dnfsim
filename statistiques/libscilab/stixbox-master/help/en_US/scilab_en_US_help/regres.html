<html><head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>regres</title>
    <style type="text/css" media="all">
      @import url("scilab_code.css");
      @import url("xml_code.css");
      @import url("c_code.css");
      @import url("style.css");
    </style>
  </head>
  <body>
    <div class="manualnavbar">
    <table width="100%"><tr>
      <td width="30%">
    	<span class="previous"><a href="lsselect.html">&lt;&lt; lsselect</a></span>

      </td>
      <td width="40%" class="center">
      	<span class="top"><a href="section_6113a9137744f426975718324677774a.html">Regression</a></span>

      </td>
      <td width="30%" class="next">
      	<span class="next"><a href="regresprint.html">regresprint &gt;&gt;</a></span>

      </td>
    </tr></table>
      <hr />
    </div>



    <span class="path"><a href="index.html">Stixbox</a> &gt;&gt; <a href="section_cce9628cc64593deeb951aad185f80cd.html">Stixbox</a> &gt; <a href="section_6113a9137744f426975718324677774a.html">Regression</a> &gt; regres</span>

    <br /><br />
    <div class="refnamediv"><h1 class="refname">regres</h1>
    <p class="refpurpose">Multiple linear regression</p></div>


<div class="refsynopsisdiv"><h3 class="title">Calling Sequence</h3>
   <div class="synopsis"><pre><span class="default">B</span><span class="default"> = </span><span class="functionid">regres</span><span class="default">(</span><span class="default">y</span><span class="default">,</span><span class="default">X</span><span class="default">)</span>
<span class="default">B</span><span class="default"> = </span><span class="functionid">regres</span><span class="default">(</span><span class="default">y</span><span class="default">,</span><span class="default">X</span><span class="default">,</span><span class="default">level</span><span class="default">)</span>
<span class="default">[</span><span class="default">B</span><span class="default">,</span><span class="default">bint</span><span class="default">] = </span><span class="functionid">regres</span><span class="default">(...)</span>
<span class="default">[</span><span class="default">B</span><span class="default">,</span><span class="default">bint</span><span class="default">,</span><span class="default">r</span><span class="default">] = </span><span class="functionid">regres</span><span class="default">(...)</span>
<span class="default">[</span><span class="default">B</span><span class="default">,</span><span class="default">bint</span><span class="default">,</span><span class="default">r</span><span class="default">,</span><span class="default">rint</span><span class="default">] = </span><span class="functionid">regres</span><span class="default">(...)</span>
<span class="default">[</span><span class="default">B</span><span class="default">,</span><span class="default">bint</span><span class="default">,</span><span class="default">r</span><span class="default">,</span><span class="default">rint</span><span class="default">,</span><span class="default">stats</span><span class="default">] = </span><span class="functionid">regres</span><span class="default">(...)</span>
<span class="default">[</span><span class="default">B</span><span class="default">,</span><span class="default">bint</span><span class="default">,</span><span class="default">r</span><span class="default">,</span><span class="default">rint</span><span class="default">,</span><span class="default">stats</span><span class="default">,</span><span class="default">fullstats</span><span class="default">] = </span><span class="functionid">regres</span><span class="default">(...)</span></pre></div></div>

<div class="refsection"><h3 class="title">Parameters</h3>
   <dl><dt><span class="term">y :</span>
      <dd><p class="para">a m-by-1 matrix of doubles, the responses.</p></dd></dt>
   <dt><span class="term">X :</span>
      <dd><p class="para">a m-by-n matrix of doubles, the inputs, where m is the number of observations and n is the number of variables.</p></dd></dt>
   <dt><span class="term">level :</span>
      <dd><p class="para">a 1-by-1 matrix of doubles, the confidence level (default level=0.05, meaning that the default level is 95%). level is expected to be in the range [0.,0.5]</p></dd></dt>
   <dt><span class="term">B :</span>
      <dd><p class="para">a n-by-1 matrix of doubles, the coefficients of the linear model.</p></dd></dt>
   <dt><span class="term">bint :</span>
      <dd><p class="para">a 2-by-2 matrix of doubles, intervals with confidence level. The column bin(:,1) are the lower bounds and bin(:,2) are the upper bounds.</p></dd></dt>
   <dt><span class="term">r :</span>
      <dd><p class="para">a m-by-1 matrix of doubles, the residuals y-B(1)-B(2)*x</p></dd></dt>
   <dt><span class="term">stats :</span>
      <dd><p class="para">a 4-by-1 matrix of doubles, the statistics. stats(1) is the R2 statistics, stats(2) is the F statistics, stats(3) is the p-value of the F statistics, stats(4) is an estimate of the error variance.</p></dd></dt>
   <dt><span class="term">fullstats :</span>
      <dd><p class="para">a struct, the statistics, see below for details.</p></dd></dt></dl></div>

<div class="refsection"><h3 class="title">Description</h3>
   <p class="para">This function computes a linear model with
n independent variables x1, x2, ..., xn
which best fit the data in the least squares sense.</p>
   <p class="para">The linear model we compute is</p>
   <p class="para">y = B(1)*x1 + B(2)*x2 +...+ B(n)*xn.</p>
   <p class="para">The fields in <code class="literal">fullstats</code> are :
<ul class="itemizedlist"><li><p class="para">fullstats.RegressionSS: the sum of squares of the regression</p></li>
<li><p class="para">fullstats.RegressionDof: the number of degrees of freedom of the regression</p></li>
<li><p class="para">fullstats.RegressionMean: the mean of the sum of squares of the regression</p></li>
<li><p class="para">fullstats.ResidualSS: the sum of squares of the residuals</p></li>
<li><p class="para">fullstats.ResidualDof: the number of degrees of freedom of the residuals</p></li>
<li><p class="para">fullstats.ResidualMean: the mean of the sum of squares of the residuals</p></li>
<li><p class="para">fullstats.F: the F statistics</p></li>
<li><p class="para">fullstats.pval : the p-value corresponding to the F statistics</p></li>
<li><p class="para">fullstats.Bstddev: a (n+1)-by-1 matrix of doubles, the standard deviation of B</p></li>
<li><p class="para">fullstats.R2: the R-squared statistics</p></li></ul></p>
   <p class="para">The residual r is :
<div class="screen"><pre>
r == y-X*B
</pre></div></p>
   <p class="para">Assuming that X and y are column vectors,
the simplest way to perform a simple linear regression
is to use the statement
<div class="screen"><pre>
B = regres(y,[ones(X),X])
</pre></div>
This adds a column of 1s, so that the model has a constant
term.</p>
   <p class="para">The statistics fullstats.R2 is in the range [0,1].
On output, the coefficient of determination fullstats.R2
measures the proportion of the variation in the response variables
that is explained by the different input values.
A value of fullstats.R2 near 1 indicates a good fit, while
a value near zero indicates a poor fit.</p>
   <p class="para">The F statistics tests the null hypothesis
B(1)==B(2)==...==B(n) agains the alternative
hypothesis that there is one nonzero B(i), for
some i=1,2,...,n.
The F test does not tell which of the B(i) is nonzero,
but only that one of them is linearly related
to the response.
When the P-value for the F test statistic is small (e.g.
less than 0.001), this provides an evidence against
the null hypothesis.
In other words, if the P-value is small,
therefore one of the parameters B(i) is linearly related
to the response.</p>
   <p class="para">Caution! If we are interested in F-statistics and
its p-value, then the X input argument should contain a
column of 1s, so that the model has a constant term.</p>
   <p class="para">Compatibility note</p>
   <p class="para">This function is mostly compatible with Matlab,
except that Matlab has no <code class="literal">fullstats</code> output argument,
which allows to have much more outputs than
the entries in <code class="literal">stat</code>.</p>
   <p class="para">In R, the feature is provided by the <code class="literal">lm</code> function and
the function <code class="literal">anova</code> prints the analysis of
variance table.
In this toolbox, this feature is provided by the
<code class="literal">regresprint</code> function,
which uses the fields in the <code class="literal">fullstats</code> variable.
This would not have been possible with the <code class="literal">stats</code>
variable alone.</p>
   <p class="para">The <code class="literal">regres</code> function name was chosen because
<code class="literal">regress</code> already exists in Scilab, but Scilab&#0039;s
<code class="literal">regress</code> is not Matlab-compatible, and has much
less features.</p>
   <p class="para"></p></div>

<div class="refsection"><h3 class="title">Examples</h3>
   <div class="programlisting"><table border="0" width="100%"><tr><td width="98%"><pre class="scilabcode"><span class="scilabcomment">// A simple linear regression</span>
<span class="scilabid">X</span> <span class="scilaboperator">=</span> <span class="scilabopenclose">[</span>
<span class="scilabnumber">57.</span>
<span class="scilabnumber">64.</span>
<span class="scilabnumber">69.</span>
<span class="scilabnumber">82.</span>
<span class="scilabnumber">92.</span>
<span class="scilabnumber">111.</span>
<span class="scilabnumber">114.</span>
<span class="scilabnumber">132.</span>
<span class="scilabnumber">144.</span>
<span class="scilabnumber">146.</span>
<span class="scilabopenclose">]</span><span class="scilabdefault">;</span>
<span class="scilabid">Y</span> <span class="scilaboperator">=</span> <span class="scilabopenclose">[</span>
<span class="scilabnumber">121.</span>
<span class="scilabnumber">129.</span>
<span class="scilabnumber">140.</span>
<span class="scilabnumber">164.</span>
<span class="scilabnumber">188.</span>
<span class="scilabnumber">217.</span>
<span class="scilabnumber">231.</span>
<span class="scilabnumber">264.</span>
<span class="scilabnumber">289.</span>
<span class="scilabnumber">294.</span>
<span class="scilabopenclose">]</span><span class="scilabdefault">;</span>
<span class="scilabid">B</span> <span class="scilaboperator">=</span> <span class="scilabid">regres</span><span class="scilabopenclose">(</span><span class="scilabid">Y</span><span class="scilabdefault">,</span><span class="scilabopenclose">[</span><a class="scilabcommand" href="scilab://ones">ones</a><span class="scilabopenclose">(</span><span class="scilabid">X</span><span class="scilabopenclose">)</span><span class="scilabdefault">,</span><span class="scilabid">X</span><span class="scilabopenclose">]</span><span class="scilabopenclose">)</span>
<span class="scilabid">expected</span> <span class="scilaboperator">=</span> <span class="scilabopenclose">[</span><span class="scilabnumber">4.8222564</span><span class="scilabdefault">;</span><span class="scilabnumber">1.9671389</span><span class="scilabopenclose">]</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// Visually check the result:</span>
<a class="scilabmacro" href="scilab://scf">scf</a><span class="scilabopenclose">(</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<a class="scilabmacro" href="scilab://plot">plot</a><span class="scilabopenclose">(</span><span class="scilabid">X</span><span class="scilabdefault">,</span><span class="scilabid">Y</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">bo</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabid">L</span> <span class="scilaboperator">=</span> <span class="scilabid">B</span><span class="scilabopenclose">(</span><span class="scilabnumber">1</span><span class="scilabopenclose">)</span><span class="scilaboperator">+</span><span class="scilabid">B</span><span class="scilabopenclose">(</span><span class="scilabnumber">2</span><span class="scilabopenclose">)</span><span class="scilaboperator">*</span><span class="scilabid">X</span><span class="scilabdefault">;</span>
<a class="scilabmacro" href="scilab://plot">plot</a><span class="scilabopenclose">(</span><span class="scilabid">X</span><span class="scilabdefault">,</span><span class="scilabid">L</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">r-</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span>
<a class="scilabmacro" href="scilab://legend">legend</a><span class="scilabopenclose">(</span><span class="scilabopenclose">[</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Data</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Linear Fit</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">]</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<a class="scilabcommand" href="scilab://xtitle">xtitle</a><span class="scilabopenclose">(</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Linear Regression</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">X</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Y</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>

<span class="scilabcomment">// Compute a 95% confidence interval.</span>
<span class="scilabcomment">// Visually check the results.</span>
<span class="scilabcomment">// Visually check the residuals.</span>
<span class="scilabcomment">// Reference : [2]</span>
<span class="scilabid">Height</span> <span class="scilaboperator">=</span> <span class="scilabopenclose">[</span>
<span class="scilabnumber">1.47</span>    <span class="scilabnumber">1.50</span>    <span class="scilabnumber">1.52</span>    <span class="scilabnumber">1.55</span>    <span class="scilabnumber">1.57</span>    <span class="scilabspecial">..</span>
<span class="scilabnumber">1.60</span>    <span class="scilabnumber">1.63</span>    <span class="scilabnumber">1.65</span>    <span class="scilabnumber">1.68</span>    <span class="scilabnumber">1.70</span>    <span class="scilabspecial">..</span>
<span class="scilabnumber">1.73</span>    <span class="scilabnumber">1.75</span>    <span class="scilabnumber">1.78</span>    <span class="scilabnumber">1.80</span>    <span class="scilabnumber">1.83</span>
<span class="scilabopenclose">]</span><span class="scilabdefault">;</span>
<span class="scilabid">Mass</span> <span class="scilaboperator">=</span><span class="scilabopenclose">[</span>
<span class="scilabnumber">52.21</span>    <span class="scilabnumber">53.12</span>    <span class="scilabnumber">54.48</span>    <span class="scilabnumber">55.84</span>    <span class="scilabnumber">57.20</span>    <span class="scilabspecial">..</span>
<span class="scilabnumber">58.57</span>    <span class="scilabnumber">59.93</span>    <span class="scilabnumber">61.29</span>    <span class="scilabnumber">63.11</span>    <span class="scilabnumber">64.47</span>    <span class="scilabspecial">..</span>
<span class="scilabnumber">66.28</span>    <span class="scilabnumber">68.10</span>    <span class="scilabnumber">69.92</span>    <span class="scilabnumber">72.19</span>    <span class="scilabnumber">74.46</span>
<span class="scilabopenclose">]</span><span class="scilabdefault">;</span>
<span class="scilabid">Height</span> <span class="scilaboperator">=</span> <span class="scilabid">Height</span><span class="scilabopenclose">(</span><span class="scilabspecial">:</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabid">Mass</span> <span class="scilaboperator">=</span> <span class="scilabid">Mass</span><span class="scilabopenclose">(</span><span class="scilabspecial">:</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabopenclose">[</span><span class="scilabid">B</span><span class="scilabdefault">,</span><span class="scilabid">bint</span><span class="scilabopenclose">]</span> <span class="scilaboperator">=</span> <span class="scilabid">regres</span><span class="scilabopenclose">(</span><span class="scilabid">Mass</span><span class="scilabdefault">,</span><span class="scilabopenclose">[</span><a class="scilabcommand" href="scilab://ones">ones</a><span class="scilabopenclose">(</span><span class="scilabid">Height</span><span class="scilabopenclose">)</span><span class="scilabdefault">,</span><span class="scilabid">Height</span><span class="scilabopenclose">]</span><span class="scilabopenclose">)</span>
<span class="scilabid">Bexpected</span> <span class="scilaboperator">=</span> <span class="scilabopenclose">[</span>
<span class="scilaboperator">-</span><span class="scilabnumber">39.062</span>
<span class="scilabnumber">61.272</span>
<span class="scilabopenclose">]</span><span class="scilabdefault">;</span>
<span class="scilabid">Bintexpected</span> <span class="scilaboperator">=</span> <span class="scilabopenclose">[</span>
<span class="scilaboperator">-</span><span class="scilabnumber">45.4</span> <span class="scilaboperator">-</span><span class="scilabnumber">32.7</span>
<span class="scilabnumber">57.4</span> <span class="scilabnumber">65.1</span>
<span class="scilabopenclose">]</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// Visually check the result:</span>
<a class="scilabmacro" href="scilab://scf">scf</a><span class="scilabopenclose">(</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<a class="scilabmacro" href="scilab://plot">plot</a><span class="scilabopenclose">(</span><span class="scilabid">Height</span><span class="scilabdefault">,</span><span class="scilabid">Mass</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">bo</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabid">L</span> <span class="scilaboperator">=</span> <span class="scilabid">B</span><span class="scilabopenclose">(</span><span class="scilabnumber">1</span><span class="scilabopenclose">)</span><span class="scilaboperator">+</span><span class="scilabid">B</span><span class="scilabopenclose">(</span><span class="scilabnumber">2</span><span class="scilabopenclose">)</span><span class="scilaboperator">*</span><span class="scilabid">Height</span><span class="scilabdefault">;</span>
<a class="scilabmacro" href="scilab://plot">plot</a><span class="scilabopenclose">(</span><span class="scilabid">Height</span><span class="scilabdefault">,</span><span class="scilabid">L</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">r-</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span>
<a class="scilabmacro" href="scilab://legend">legend</a><span class="scilabopenclose">(</span><span class="scilabopenclose">[</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Data</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Linear Fit</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">]</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<a class="scilabcommand" href="scilab://xtitle">xtitle</a><span class="scilabopenclose">(</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Linear Regression</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Height</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Mass</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// Compute the residuals</span>
<span class="scilabopenclose">[</span><span class="scilabid">B</span><span class="scilabdefault">,</span><span class="scilabid">bint</span><span class="scilabdefault">,</span><span class="scilabid">r</span><span class="scilabopenclose">]</span> <span class="scilaboperator">=</span> <span class="scilabid">regres</span><span class="scilabopenclose">(</span><span class="scilabid">Mass</span><span class="scilabdefault">,</span><span class="scilabopenclose">[</span><a class="scilabcommand" href="scilab://ones">ones</a><span class="scilabopenclose">(</span><span class="scilabid">Height</span><span class="scilabopenclose">)</span><span class="scilabdefault">,</span><span class="scilabid">Height</span><span class="scilabopenclose">]</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// Visually see the residuals</span>
<a class="scilabmacro" href="scilab://scf">scf</a><span class="scilabopenclose">(</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<a class="scilabmacro" href="scilab://plot">plot</a><span class="scilabopenclose">(</span><span class="scilabid">Height</span><span class="scilabdefault">,</span><span class="scilabid">r</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">bo</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<a class="scilabcommand" href="scilab://xtitle">xtitle</a><span class="scilabopenclose">(</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Linear Regression</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Height</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Residuals</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// A quadratic fit would be better:</span>
<span class="scilabcomment">// we see a quadratic pattern in the residuals.</span>

<span class="scilabcomment">// Longley.dat contains 1 Response Variable y,</span>
<span class="scilabcomment">// 6 Predictor Variables x and 16 Observations.</span>
<span class="scilabcomment">// Source : [4]</span>
<span class="scilabid">X</span> <span class="scilaboperator">=</span> <span class="scilabopenclose">[</span>
<span class="scilabnumber">83.0</span> <span class="scilabnumber">234289</span> <span class="scilabnumber">2356</span> <span class="scilabnumber">1590</span> <span class="scilabnumber">107608</span> <span class="scilabnumber">1947</span>
<span class="scilabnumber">88.5</span> <span class="scilabnumber">259426</span> <span class="scilabnumber">2325</span> <span class="scilabnumber">1456</span> <span class="scilabnumber">108632</span> <span class="scilabnumber">1948</span>
<span class="scilabnumber">88.2</span> <span class="scilabnumber">258054</span> <span class="scilabnumber">3682</span> <span class="scilabnumber">1616</span> <span class="scilabnumber">109773</span> <span class="scilabnumber">1949</span>
<span class="scilabnumber">89.5</span> <span class="scilabnumber">284599</span> <span class="scilabnumber">3351</span> <span class="scilabnumber">1650</span> <span class="scilabnumber">110929</span> <span class="scilabnumber">1950</span>
<span class="scilabnumber">96.2</span> <span class="scilabnumber">328975</span> <span class="scilabnumber">2099</span> <span class="scilabnumber">3099</span> <span class="scilabnumber">112075</span> <span class="scilabnumber">1951</span>
<span class="scilabnumber">98.1</span> <span class="scilabnumber">346999</span> <span class="scilabnumber">1932</span> <span class="scilabnumber">3594</span> <span class="scilabnumber">113270</span> <span class="scilabnumber">1952</span>
<span class="scilabnumber">99.0</span> <span class="scilabnumber">365385</span> <span class="scilabnumber">1870</span> <span class="scilabnumber">3547</span> <span class="scilabnumber">115094</span> <span class="scilabnumber">1953</span>
<span class="scilabnumber">100.0</span> <span class="scilabnumber">363112</span> <span class="scilabnumber">3578</span> <span class="scilabnumber">3350</span> <span class="scilabnumber">116219</span> <span class="scilabnumber">1954</span>
<span class="scilabnumber">101.2</span> <span class="scilabnumber">397469</span> <span class="scilabnumber">2904</span> <span class="scilabnumber">3048</span> <span class="scilabnumber">117388</span> <span class="scilabnumber">1955</span>
<span class="scilabnumber">104.6</span> <span class="scilabnumber">419180</span> <span class="scilabnumber">2822</span> <span class="scilabnumber">2857</span> <span class="scilabnumber">118734</span> <span class="scilabnumber">1956</span>
<span class="scilabnumber">108.4</span> <span class="scilabnumber">442769</span> <span class="scilabnumber">2936</span> <span class="scilabnumber">2798</span> <span class="scilabnumber">120445</span> <span class="scilabnumber">1957</span>
<span class="scilabnumber">110.8</span> <span class="scilabnumber">444546</span> <span class="scilabnumber">4681</span> <span class="scilabnumber">2637</span> <span class="scilabnumber">121950</span> <span class="scilabnumber">1958</span>
<span class="scilabnumber">112.6</span> <span class="scilabnumber">482704</span> <span class="scilabnumber">3813</span> <span class="scilabnumber">2552</span> <span class="scilabnumber">123366</span> <span class="scilabnumber">1959</span>
<span class="scilabnumber">114.2</span> <span class="scilabnumber">502601</span> <span class="scilabnumber">3931</span> <span class="scilabnumber">2514</span> <span class="scilabnumber">125368</span> <span class="scilabnumber">1960</span>
<span class="scilabnumber">115.7</span> <span class="scilabnumber">518173</span> <span class="scilabnumber">4806</span> <span class="scilabnumber">2572</span> <span class="scilabnumber">127852</span> <span class="scilabnumber">1961</span>
<span class="scilabnumber">116.9</span> <span class="scilabnumber">554894</span> <span class="scilabnumber">4007</span> <span class="scilabnumber">2827</span> <span class="scilabnumber">130081</span> <span class="scilabnumber">1962</span>
<span class="scilabopenclose">]</span><span class="scilabdefault">;</span>
<span class="scilabid">y</span> <span class="scilaboperator">=</span> <span class="scilabopenclose">[</span>
<span class="scilabnumber">60323</span>
<span class="scilabnumber">61122</span>
<span class="scilabnumber">60171</span>
<span class="scilabnumber">61187</span>
<span class="scilabnumber">63221</span>
<span class="scilabnumber">63639</span>
<span class="scilabnumber">64989</span>
<span class="scilabnumber">63761</span>
<span class="scilabnumber">66019</span>
<span class="scilabnumber">67857</span>
<span class="scilabnumber">68169</span>
<span class="scilabnumber">66513</span>
<span class="scilabnumber">68655</span>
<span class="scilabnumber">69564</span>
<span class="scilabnumber">69331</span>
<span class="scilabnumber">70551</span>
<span class="scilabopenclose">]</span><span class="scilabdefault">;</span>
<span class="scilabopenclose">[</span><span class="scilabid">B</span><span class="scilabdefault">,</span><span class="scilabid">bint</span><span class="scilabdefault">,</span><span class="scilabid">r</span><span class="scilabdefault">,</span><span class="scilabid">rint</span><span class="scilabdefault">,</span><span class="scilabid">stats</span><span class="scilabdefault">,</span><span class="scilabid">fullstats</span><span class="scilabopenclose">]</span> <span class="scilaboperator">=</span> <span class="scilabid">regres</span><span class="scilabopenclose">(</span><span class="scilabid">y</span><span class="scilabdefault">,</span><span class="scilabid">X</span><span class="scilabopenclose">)</span>
<span class="scilabcomment">// Print an analysis of variance table</span>
<span class="scilabid">scidoe_regressprint</span><span class="scilabopenclose">(</span><span class="scilabid">fullstats</span><span class="scilabopenclose">)</span>

<span class="scilabcomment">// Create an example with known coefficients</span>
<a class="scilabcommand" href="scilab://grand">grand</a><span class="scilabopenclose">(</span><span class="scilabstring">&#0034;</span><span class="scilabstring">setsd</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabnumber">0</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// The number of observations</span>
<span class="scilabid">N</span> <span class="scilaboperator">=</span> <span class="scilabnumber">100</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// The exact coefficients</span>
<span class="scilabid">Bexact</span> <span class="scilaboperator">=</span> <span class="scilabopenclose">[</span><span class="scilabnumber">2000</span><span class="scilabdefault">;</span><span class="scilabnumber">3</span><span class="scilabdefault">;</span><span class="scilabnumber">4</span><span class="scilabopenclose">]</span>
<span class="scilabcomment">// The input 1</span>
<span class="scilabid">X1min</span> <span class="scilaboperator">=</span> <span class="scilabnumber">50</span><span class="scilabdefault">;</span>
<span class="scilabid">X1max</span> <span class="scilaboperator">=</span> <span class="scilabnumber">150</span><span class="scilabdefault">;</span>
<span class="scilabid">X1</span><span class="scilaboperator">=</span><a class="scilabcommand" href="scilab://grand">grand</a><span class="scilabopenclose">(</span><span class="scilabid">N</span><span class="scilabdefault">,</span><span class="scilabnumber">1</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">uin</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabid">X1min</span><span class="scilabdefault">,</span><span class="scilabid">X1max</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabid">X1</span><span class="scilaboperator">=</span><a class="scilabcommand" href="scilab://gsort">gsort</a><span class="scilabopenclose">(</span><span class="scilabid">X1</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">g</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">i</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// The input 2</span>
<span class="scilabid">X2min</span> <span class="scilaboperator">=</span> <span class="scilaboperator">-</span><span class="scilabnumber">500</span><span class="scilabdefault">;</span>
<span class="scilabid">X2max</span> <span class="scilaboperator">=</span> <span class="scilaboperator">-</span><span class="scilabnumber">200</span><span class="scilabdefault">;</span>
<span class="scilabid">X2</span><span class="scilaboperator">=</span><a class="scilabcommand" href="scilab://grand">grand</a><span class="scilabopenclose">(</span><span class="scilabid">N</span><span class="scilabdefault">,</span><span class="scilabnumber">1</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">uin</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabid">X2min</span><span class="scilabdefault">,</span><span class="scilabid">X2max</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabid">X2</span><span class="scilaboperator">=</span><a class="scilabcommand" href="scilab://gsort">gsort</a><span class="scilabopenclose">(</span><span class="scilabid">X2</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">g</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">i</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// Make the observations</span>
<span class="scilabid">X</span> <span class="scilaboperator">=</span> <span class="scilabopenclose">[</span><a class="scilabcommand" href="scilab://ones">ones</a><span class="scilabopenclose">(</span><span class="scilabid">X1</span><span class="scilabopenclose">)</span><span class="scilabdefault">,</span><span class="scilabid">X1</span><span class="scilabdefault">,</span><span class="scilabid">X2</span><span class="scilabopenclose">]</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// Compute the ouput from the input</span>
<span class="scilabid">y</span> <span class="scilaboperator">=</span> <span class="scilabid">Bexact</span><span class="scilabopenclose">(</span><span class="scilabnumber">1</span><span class="scilabopenclose">)</span><span class="scilaboperator">+</span><span class="scilabid">Bexact</span><span class="scilabopenclose">(</span><span class="scilabnumber">2</span><span class="scilabopenclose">)</span><span class="scilaboperator">*</span><span class="scilabid">X1</span><span class="scilaboperator">+</span><span class="scilabid">Bexact</span><span class="scilabopenclose">(</span><span class="scilabnumber">3</span><span class="scilabopenclose">)</span><span class="scilaboperator">*</span><span class="scilabid">X2</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// Add a normal noise to the output</span>
<span class="scilabid">sigma</span> <span class="scilaboperator">=</span> <span class="scilabnumber">50</span><span class="scilabdefault">;</span>
<span class="scilabid">e</span> <span class="scilaboperator">=</span> <a class="scilabcommand" href="scilab://grand">grand</a><span class="scilabopenclose">(</span><span class="scilabid">N</span><span class="scilabdefault">,</span><span class="scilabnumber">1</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">nor</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabnumber">0</span><span class="scilabdefault">,</span><span class="scilabid">sigma</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabid">y</span> <span class="scilaboperator">=</span> <a class="scilabcommand" href="scilab://int">int</a><span class="scilabopenclose">(</span><span class="scilabid">y</span> <span class="scilaboperator">+</span> <span class="scilabid">e</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// Linear regression</span>
<span class="scilabid">B</span> <span class="scilaboperator">=</span> <span class="scilabid">regres</span><span class="scilabopenclose">(</span><span class="scilabid">y</span><span class="scilabdefault">,</span><span class="scilabid">X</span><span class="scilabopenclose">)</span>
<span class="scilabcomment">// Compare B (exact) with B (estimate)</span>
<span class="scilabopenclose">[</span><span class="scilabid">B</span><span class="scilabdefault">,</span><span class="scilabid">Bexact</span><span class="scilabopenclose">]</span>
<span class="scilabid">L</span> <span class="scilaboperator">=</span> <span class="scilabid">B</span><span class="scilabopenclose">(</span><span class="scilabnumber">1</span><span class="scilabopenclose">)</span><span class="scilaboperator">+</span><span class="scilabid">B</span><span class="scilabopenclose">(</span><span class="scilabnumber">2</span><span class="scilabopenclose">)</span><span class="scilaboperator">*</span><span class="scilabid">X</span><span class="scilabopenclose">(</span><span class="scilabspecial">:</span><span class="scilabdefault">,</span><span class="scilabnumber">2</span><span class="scilabopenclose">)</span><span class="scilaboperator">+</span><span class="scilabid">B</span><span class="scilabopenclose">(</span><span class="scilabnumber">3</span><span class="scilabopenclose">)</span><span class="scilaboperator">*</span><span class="scilabid">X</span><span class="scilabopenclose">(</span><span class="scilabspecial">:</span><span class="scilabdefault">,</span><span class="scilabnumber">3</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabcomment">// Check visually</span>
<a class="scilabmacro" href="scilab://scf">scf</a><span class="scilabopenclose">(</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<a class="scilabmacro" href="scilab://plot">plot</a><span class="scilabopenclose">(</span><span class="scilabid">y</span><span class="scilabdefault">,</span><span class="scilabid">L</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">bo</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<a class="scilabmacro" href="scilab://plot">plot</a><span class="scilabopenclose">(</span><span class="scilabid">y</span><span class="scilabdefault">,</span><span class="scilabid">y</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">r-</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<a class="scilabcommand" href="scilab://xtitle">xtitle</a><span class="scilabopenclose">(</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Linear Regression</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Data</span><span class="scilabstring">&#0034;</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">Linear Fit</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>

<span class="scilabcomment">// A short example of univariate linear regression</span>
<span class="scilabid">X</span> <span class="scilaboperator">=</span> <a class="scilabcommand" href="scilab://rand">rand</a><span class="scilabopenclose">(</span><span class="scilabnumber">30</span><span class="scilabdefault">,</span><span class="scilabnumber">1</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">n</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<span class="scilabid">Y</span> <span class="scilaboperator">=</span> <span class="scilabnumber">2</span><span class="scilaboperator">+</span><span class="scilabnumber">3</span><span class="scilaboperator">*</span><span class="scilabid">X</span><span class="scilaboperator">+</span><a class="scilabcommand" href="scilab://rand">rand</a><span class="scilabopenclose">(</span><span class="scilabnumber">30</span><span class="scilabdefault">,</span><span class="scilabnumber">1</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">n</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<a class="scilabmacro" href="scilab://scf">scf</a><span class="scilabopenclose">(</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<a class="scilabmacro" href="scilab://plot">plot</a><span class="scilabopenclose">(</span><span class="scilabid">X</span><span class="scilabdefault">,</span><span class="scilabid">Y</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">bo</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span>
<span class="scilabid">B</span> <span class="scilaboperator">=</span> <span class="scilabid">scidoe_regress</span><span class="scilabopenclose">(</span><span class="scilabid">Y</span><span class="scilabdefault">,</span><span class="scilabopenclose">[</span><a class="scilabcommand" href="scilab://ones">ones</a><span class="scilabopenclose">(</span><span class="scilabid">X</span><span class="scilabopenclose">)</span><span class="scilabdefault">,</span><span class="scilabid">X</span><span class="scilabopenclose">]</span><span class="scilabopenclose">)</span><span class="scilabdefault">;</span>
<a class="scilabmacro" href="scilab://plot">plot</a><span class="scilabopenclose">(</span><span class="scilabid">X</span><span class="scilabdefault">,</span><span class="scilabid">B</span><span class="scilabopenclose">(</span><span class="scilabnumber">1</span><span class="scilabopenclose">)</span><span class="scilaboperator">*</span><a class="scilabcommand" href="scilab://ones">ones</a><span class="scilabopenclose">(</span><span class="scilabid">X</span><span class="scilabopenclose">)</span><span class="scilaboperator">+</span><span class="scilabid">B</span><span class="scilabopenclose">(</span><span class="scilabnumber">2</span><span class="scilabopenclose">)</span><span class="scilaboperator">*</span><span class="scilabid">X</span><span class="scilabdefault">,</span><span class="scilabstring">&#0034;</span><span class="scilabstring">r-</span><span class="scilabstring">&#0034;</span><span class="scilabopenclose">)</span>
<span class="scilabcomment">// To see which points are there, please use:</span>
<span class="scilabcomment">// identify(X,Y,1)</span>
<span class="scilabcomment">// Click middle button to leave.</span></pre></td><td valign="top"><a href="scilab://scilab.execexample/"><img src="ScilabExecute.png" border="0"/></a></td><td valign="top"><a href="scilab://scilab.editexample/"><img src="ScilabEdit.png" border="0"/></a></td><td></td></tr></table></div></div>

<div class="refsection"><h3 class="title">Authors</h3>
   <ul class="itemizedlist"><li class="member">Copyright (C) 2012-2013 - Michael Baudin</li>
   <li class="member">Copyright (C) 2012 - Maria Christopoulou</li>
   <li class="member">Copyright (C) 2009 - Yann Collette</li></ul></div>

<div class="refsection"><h3 class="title">Bibliography</h3>
   <p class="para">[1] &#0034;Introduction to probability and statistics for engineers and scientists.&#0034;, Third Edition, Sheldon Ross, Elsevier Academic Press, 2004</p>
   <p class="para">[2] http://en.wikipedia.org/wiki/Linear_regression</p>
   <p class="para">[3] Octave&#0039;s regres, William Poetra Yoga Hadisoeseno</p>
   <p class="para">[4] http://www.itl.nist.gov/div898/strd/lls/data/LINKS/DATA/Longley.dat</p></div>
    <br />

    <div class="manualnavbar">
    <table width="100%">
    <tr><td colspan="3" class="next"><a href="http://bugzilla.scilab.org/enter_bug.cgi?product=Scilab%20software&component=Documentation%20pages" class="ulink">Report an issue</a></td></tr>
<tr>
      <td width="30%">
    	<span class="previous"><a href="lsselect.html">&lt;&lt; lsselect</a></span>

      </td>
      <td width="40%" class="center">
      	<span class="top"><a href="section_6113a9137744f426975718324677774a.html">Regression</a></span>

      </td>
      <td width="30%" class="next">
      	<span class="next"><a href="regresprint.html">regresprint &gt;&gt;</a></span>

      </td>
    </tr></table>
      <hr />
    </div>
  </body>
</html>
